/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * ClassPanel.java
 *
 * Created on 14/06/2013, 15:48:46
 */
package Interface;

import dsproject.Turma;
import dsproject.Professor;
import dsproject.Escola;
import java.awt.Color;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.util.ArrayList;
import java.util.Collections;
import javax.swing.DefaultListModel;
import javax.swing.JOptionPane;

/**
 *
 * @author Günther
 */
public class ClassPanel extends javax.swing.JPanel {

    /** Creates new form ClassPanel */
    public ClassPanel() {
        initComponents();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        newClassPanel = new javax.swing.JPanel();
        labelTurma = new javax.swing.JLabel();
        campoTurma = new javax.swing.JTextField();
        labelAnoLetivo = new javax.swing.JLabel();
        campoAnoLetivo = new javax.swing.JTextField();
        botaoCadastrar = new javax.swing.JButton();
        listClassesPanel = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        listaListaDeTurmas = new DefaultListModel();
        listaDeTurmas = new javax.swing.JList(listaListaDeTurmas);
        editClassPanel = new javax.swing.JPanel();
        labelTurmaEditarTurma = new javax.swing.JLabel();
        comboTurmaEditarTurma = new javax.swing.JComboBox();
        labelAnoLetivoEditarTurma = new javax.swing.JLabel();
        campoAnoLetivoEditarTurma = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        comboAdicionarAluno = new javax.swing.JComboBox();
        botaoRemoverEditarTurma = new javax.swing.JButton();
        botaoAdicionarEditarTurma = new javax.swing.JButton();
        comboRemoverAluno = new javax.swing.JComboBox();
        jLabel9 = new javax.swing.JLabel();
        botaoSalvar = new javax.swing.JButton();
        deleteClassPanel = new javax.swing.JPanel();
        labelTurmaRemoverTurma = new javax.swing.JLabel();
        comboTurma = new javax.swing.JComboBox();
        botaoRemover = new javax.swing.JButton();

        setMinimumSize(new java.awt.Dimension(833, 515));
        setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        newClassPanel.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        labelTurma.setText("Turma");
        newClassPanel.add(labelTurma, new org.netbeans.lib.awtextra.AbsoluteConstraints(208, 26, -1, -1));

        campoTurma.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                campoTurmaKeyTyped(evt);
            }
        });
        newClassPanel.add(campoTurma, new org.netbeans.lib.awtextra.AbsoluteConstraints(265, 21, 110, -1));

        labelAnoLetivo.setText("Ano Letivo");
        newClassPanel.add(labelAnoLetivo, new org.netbeans.lib.awtextra.AbsoluteConstraints(436, 26, -1, -1));

        campoAnoLetivo.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                campoAnoLetivoKeyTyped(evt);
            }
        });
        newClassPanel.add(campoAnoLetivo, new org.netbeans.lib.awtextra.AbsoluteConstraints(520, 21, 110, -1));

        botaoCadastrar.setText("Cadastrar");
        botaoCadastrar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botaoCadastrarActionPerformed(evt);
            }
        });
        newClassPanel.add(botaoCadastrar, new org.netbeans.lib.awtextra.AbsoluteConstraints(680, 80, -1, -1));

        jTabbedPane1.addTab("Cadastrar Turma", newClassPanel);

        listClassesPanel.addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                listClassesPanelComponentShown(evt);
            }
        });
        listClassesPanel.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        listaDeTurmas.setBackground(new java.awt.Color(240, 240, 240));
        jScrollPane2.setViewportView(listaDeTurmas);

        listClassesPanel.add(jScrollPane2, new org.netbeans.lib.awtextra.AbsoluteConstraints(31, 33, 763, 422));

        jTabbedPane1.addTab("Lista de Turmas", listClassesPanel);

        editClassPanel.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        labelTurmaEditarTurma.setText("Turma");
        editClassPanel.add(labelTurmaEditarTurma, new org.netbeans.lib.awtextra.AbsoluteConstraints(208, 26, -1, -1));

        comboTurmaEditarTurma.addPopupMenuListener(new javax.swing.event.PopupMenuListener() {
            public void popupMenuCanceled(javax.swing.event.PopupMenuEvent evt) {
            }
            public void popupMenuWillBecomeInvisible(javax.swing.event.PopupMenuEvent evt) {
            }
            public void popupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt) {
                comboTurmaEditarTurmaPopupMenuWillBecomeVisible(evt);
            }
        });
        comboTurmaEditarTurma.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboTurmaEditarTurmaItemStateChanged(evt);
            }
        });
        editClassPanel.add(comboTurmaEditarTurma, new org.netbeans.lib.awtextra.AbsoluteConstraints(265, 21, 110, -1));

        labelAnoLetivoEditarTurma.setText("Ano Letivo");
        editClassPanel.add(labelAnoLetivoEditarTurma, new org.netbeans.lib.awtextra.AbsoluteConstraints(436, 26, -1, -1));
        editClassPanel.add(campoAnoLetivoEditarTurma, new org.netbeans.lib.awtextra.AbsoluteConstraints(520, 21, 110, -1));

        jLabel8.setText("Adicionar Aluno");
        editClassPanel.add(jLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(12, 118, -1, -1));

        comboAdicionarAluno.addPopupMenuListener(new javax.swing.event.PopupMenuListener() {
            public void popupMenuCanceled(javax.swing.event.PopupMenuEvent evt) {
            }
            public void popupMenuWillBecomeInvisible(javax.swing.event.PopupMenuEvent evt) {
            }
            public void popupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt) {
                comboAdicionarAlunoPopupMenuWillBecomeVisible(evt);
            }
        });
        editClassPanel.add(comboAdicionarAluno, new org.netbeans.lib.awtextra.AbsoluteConstraints(137, 113, 676, -1));

        botaoRemoverEditarTurma.setText("Remover");
        editClassPanel.add(botaoRemoverEditarTurma, new org.netbeans.lib.awtextra.AbsoluteConstraints(728, 267, 85, -1));

        botaoAdicionarEditarTurma.setText("Adicionar");
        botaoAdicionarEditarTurma.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botaoAdicionarEditarTurmaActionPerformed(evt);
            }
        });
        editClassPanel.add(botaoAdicionarEditarTurma, new org.netbeans.lib.awtextra.AbsoluteConstraints(726, 152, 87, -1));

        editClassPanel.add(comboRemoverAluno, new org.netbeans.lib.awtextra.AbsoluteConstraints(137, 228, 676, -1));

        jLabel9.setText(" Remover Aluno");
        editClassPanel.add(jLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(12, 233, -1, -1));

        botaoSalvar.setText("Salvar");
        editClassPanel.add(botaoSalvar, new org.netbeans.lib.awtextra.AbsoluteConstraints(728, 448, 85, -1));

        jTabbedPane1.addTab("Editar Turma", editClassPanel);

        deleteClassPanel.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        labelTurmaRemoverTurma.setText("Turma");
        deleteClassPanel.add(labelTurmaRemoverTurma, new org.netbeans.lib.awtextra.AbsoluteConstraints(101, 27, -1, -1));

        comboTurma.addPopupMenuListener(new javax.swing.event.PopupMenuListener() {
            public void popupMenuCanceled(javax.swing.event.PopupMenuEvent evt) {
            }
            public void popupMenuWillBecomeInvisible(javax.swing.event.PopupMenuEvent evt) {
            }
            public void popupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt) {
                comboTurmaPopupMenuWillBecomeVisible(evt);
            }
        });
        deleteClassPanel.add(comboTurma, new org.netbeans.lib.awtextra.AbsoluteConstraints(191, 22, 500, -1));

        botaoRemover.setText("Remover");
        deleteClassPanel.add(botaoRemover, new org.netbeans.lib.awtextra.AbsoluteConstraints(605, 67, 86, -1));

        jTabbedPane1.addTab("Remover Turma", deleteClassPanel);

        add(jTabbedPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 833, 515));
    }// </editor-fold>//GEN-END:initComponents

    private void botaoAdicionarEditarTurmaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botaoAdicionarEditarTurmaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botaoAdicionarEditarTurmaActionPerformed

   private void campoAnoLetivoKeyTyped(java.awt.event.KeyEvent evt)//GEN-FIRST:event_campoAnoLetivoKeyTyped
   {//GEN-HEADEREND:event_campoAnoLetivoKeyTyped
      if(!Character.isDigit(evt.getKeyChar()))
      {
         evt.setKeyChar('\0');
      }
      else
      {
         String textoCampo = campoAnoLetivo.getText();
         if(textoCampo.length() > 3)
            evt.setKeyChar('\0');
      }
   }//GEN-LAST:event_campoAnoLetivoKeyTyped

   private void comboAdicionarAlunoPopupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt)//GEN-FIRST:event_comboAdicionarAlunoPopupMenuWillBecomeVisible
   {//GEN-HEADEREND:event_comboAdicionarAlunoPopupMenuWillBecomeVisible
      Object isNull;
      isNull = comboAdicionarAluno.getItemAt(0);
      int i = 0;
      
      if(isStudentAddedComboAdicionarAluno() && isNull == null)
      {
         i = 0;
         comboAdicionarAluno.addItem("");
         
         if(MainPanel.alunosLidos != null)
         {
            while(i < MainPanel.alunosLidos.size())
            {
               if(MainPanel.alunosLidos.get(i).getTurma() == null)
               {
                  comboAdicionarAluno.addItem(MainPanel.alunosLidos.get(i).getNome());
               }
               i++;
            }
         }
         
         setStudentAddedComboAdicionarAluno(false);
         setNumeroDeAlunosAdicionadosComboAdicionarAluno(0);
      }
      else
      {
         if(isStudentAddedComboAdicionarAluno() && isNull != null)
         {
            i = (MainPanel.alunosLidos.size() - getNumeroDeAlunosAdicionadosComboAdicionarAluno());
            
            if(MainPanel.alunosLidos != null)
            {
               while(i < MainPanel.alunosLidos.size())
               {
                  if(MainPanel.alunosLidos.get(i).getTurma() == null)
                  {
                     comboAdicionarAluno.addItem(MainPanel.alunosLidos.get(i).getNome());
                  }
                  i++;
               }
            }
            
            setStudentAddedComboAdicionarAluno(false);
            setNumeroDeAlunosAdicionadosComboAdicionarAluno(0);
         }
         else
         {
            if(isNull == null)
            {
               i = 0;
               comboAdicionarAluno.addItem("");
               
               if(MainPanel.alunosLidos != null)
               {
                  while(i < MainPanel.alunosLidos.size())
                  {
                     if(MainPanel.alunosLidos.get(i).getTurma() == null)
                     {
                        comboAdicionarAluno.addItem(MainPanel.alunosLidos.get(i).getNome());
                     }
                     i++;
                  }
               }
            }
         }
      }
   }//GEN-LAST:event_comboAdicionarAlunoPopupMenuWillBecomeVisible

   private void listClassesPanelComponentShown(java.awt.event.ComponentEvent evt)//GEN-FIRST:event_listClassesPanelComponentShown
   {//GEN-HEADEREND:event_listClassesPanelComponentShown
       listaListaDeTurmas.clear();
       Professor tmpProf = Escola.getInstance().getLogado();
       for (int i = 0; i < tmpProf.getTurmas().size(); i++) {
           listaListaDeTurmas.addElement(tmpProf.getTurmas().get(i).getId());
       }
   }//GEN-LAST:event_listClassesPanelComponentShown

   private void comboTurmaEditarTurmaPopupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt)//GEN-FIRST:event_comboTurmaEditarTurmaPopupMenuWillBecomeVisible
   {//GEN-HEADEREND:event_comboTurmaEditarTurmaPopupMenuWillBecomeVisible
      comboTurmaEditarTurma.removeAllItems();
      Professor tmpProf = Escola.getInstance().getLogado();
      for (int i = 0; i < tmpProf.getTurmas().size(); i++) {
           comboTurmaEditarTurma.addItem(tmpProf.getTurmas().get(i).getId());
      }
   }//GEN-LAST:event_comboTurmaEditarTurmaPopupMenuWillBecomeVisible

   private void comboTurmaEditarTurmaItemStateChanged(java.awt.event.ItemEvent evt)//GEN-FIRST:event_comboTurmaEditarTurmaItemStateChanged
   {//GEN-HEADEREND:event_comboTurmaEditarTurmaItemStateChanged
      
   }//GEN-LAST:event_comboTurmaEditarTurmaItemStateChanged

   private void comboTurmaPopupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt)//GEN-FIRST:event_comboTurmaPopupMenuWillBecomeVisible
   {//GEN-HEADEREND:event_comboTurmaPopupMenuWillBecomeVisible
      comboTurma.removeAllItems();
      Professor tmpProf = Escola.getInstance().getLogado();
      for (int i = 0; i < tmpProf.getTurmas().size(); i++) {
           comboTurma.addItem(tmpProf.getTurmas().get(i).getId());
      }
   }//GEN-LAST:event_comboTurmaPopupMenuWillBecomeVisible

    private void campoTurmaKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_campoTurmaKeyTyped
        // TODO add your handling code here:
    }//GEN-LAST:event_campoTurmaKeyTyped

    private void botaoCadastrarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botaoCadastrarActionPerformed
        Professor tmpProf = Escola.getInstance().getLogado();
        erroslist = tmpProf.cadastrarTurma(getCampoTurma(), getCampoAnoLetivo());
        
        int error;
        if(erroslist.get(0).equals(0)){
            // sem erros - tudo lindo
            labelTurma.setForeground(Color.black);
            labelAnoLetivo.setForeground(Color.black);
            limpaCamposCadastrarTurma();
            return;
        }else{
            for(int i =0 ; i< erroslist.size();i++){
                error = erroslist.get(i);
                switch(error)
                {
                    case(1):
                        //erro cpf
                        labelTurma.setForeground(Color.red);
                        break;
                    case(2):
                        // error nome
                        labelTurma.setForeground(Color.red);
                        break;
                    case(3):
                        //error endereço
                        labelAnoLetivo.setForeground(Color.red);
                        break;
                }         
            }
        }
        
    }//GEN-LAST:event_botaoCadastrarActionPerformed
    
    private ArrayList<Integer> erroslist ;
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton botaoAdicionarEditarTurma;
    private javax.swing.JButton botaoCadastrar;
    private javax.swing.JButton botaoRemover;
    private javax.swing.JButton botaoRemoverEditarTurma;
    private javax.swing.JButton botaoSalvar;
    private javax.swing.ButtonGroup buttonGroup1;
    private static javax.swing.JTextField campoAnoLetivo;
    private javax.swing.JTextField campoAnoLetivoEditarTurma;
    private static javax.swing.JTextField campoTurma;
    private static javax.swing.JComboBox comboAdicionarAluno;
    private static javax.swing.JComboBox comboRemoverAluno;
    private javax.swing.JComboBox comboTurma;
    private javax.swing.JComboBox comboTurmaEditarTurma;
    private javax.swing.JPanel deleteClassPanel;
    private javax.swing.JPanel editClassPanel;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTabbedPane jTabbedPane1;
    private static javax.swing.JLabel labelAnoLetivo;
    private javax.swing.JLabel labelAnoLetivoEditarTurma;
    private static javax.swing.JLabel labelTurma;
    private javax.swing.JLabel labelTurmaEditarTurma;
    private javax.swing.JLabel labelTurmaRemoverTurma;
    private javax.swing.JPanel listClassesPanel;
    private javax.swing.JList listaDeTurmas;
    private javax.swing.JPanel newClassPanel;
    // End of variables declaration//GEN-END:variables
   private static DefaultListModel listaAlunosMatriculados;
   private static DefaultListModel listaListaDeTurmas;
   private static boolean alunoAdicionadoComboAluno;
   private static boolean alunoAdicionadoComboNomeDoAluno;
   private static boolean alunoAdicionadoComboAdicionarAluno;
   private static boolean turmaAdicionada;
   private static boolean turmaAdicionadaComboTurmaEditarTurmas;
   private static boolean turmaAdicionadaComboTurma;
   private static int numeroDeTurmasAdicionadasComboTurma = 0;
   private static int numeroDeTurmasAdicionadasComboTurmaEditarTurmas = 0;
   private static int numeroDeTurmasAdicionadas = 0;
   private static int numeroDeAlunosAdicionadosComboAluno = 0;
   private static int numeroDeAlunosAdicionadosComboNomeDoAluno = 0;
   private static int numeroDeAlunosAdicionadosComboAdicionarAluno = 0;

   public static boolean isTurmaAdicionadaComboTurma()
   {
      return turmaAdicionadaComboTurma;
   }

   public static void setTurmaAdicionadaComboTurma(boolean turmaAdicionadaComboTurma)
   {
      ClassPanel.turmaAdicionadaComboTurma = turmaAdicionadaComboTurma;
   }

   public static int getNumeroDeTurmasAdicionadasComboTurma()
   {
      return numeroDeTurmasAdicionadasComboTurma;
   }

   public static void setNumeroDeTurmasAdicionadasComboTurma(int numeroDeTurmasAdicionadasComboTurma)
   {
      ClassPanel.numeroDeTurmasAdicionadasComboTurma = numeroDeTurmasAdicionadasComboTurma;
   }
   
   public static boolean isTurmaAdicionadaComboTurmaEditarTurmas()
   {
      return turmaAdicionadaComboTurmaEditarTurmas;
   }

   public static void setTurmaAdicionadaComboTurmaEditarTurmas(boolean turmaAdicionadaEditarTurmas)
   {
      ClassPanel.turmaAdicionadaComboTurmaEditarTurmas = turmaAdicionadaEditarTurmas;
   }

   public static int getNumeroDeTurmasAdicionadasComboTurmaEditarTurmas()
   {
      return numeroDeTurmasAdicionadasComboTurmaEditarTurmas;
   }

   public static void setNumeroDeTurmasAdicionadasComboTurmaEditarTurmas(int numeroDeTurmasAdicionadasEditarTurmas)
   {
      ClassPanel.numeroDeTurmasAdicionadasComboTurmaEditarTurmas = numeroDeTurmasAdicionadasEditarTurmas;
   }
   
   public static boolean isTurmaAdicionada()
   {
      return turmaAdicionada;
   }

   public static void setTurmaAdicionada(boolean turmaAdicionada)
   {
      ClassPanel.turmaAdicionada = turmaAdicionada;
   }

   public static int getNumeroDeTurmasAdicionadas()
   {
      return numeroDeTurmasAdicionadas;
   }

   public static void setNumeroDeTurmasAdicionadas(int numeroDeTurmasAdicionadas)
   {
      ClassPanel.numeroDeTurmasAdicionadas = numeroDeTurmasAdicionadas;
   }
   
   public static int getNumeroDeAlunosAdicionadosComboAluno()
   {
      return numeroDeAlunosAdicionadosComboAluno;
   }

   public static void setNumeroDeAlunosAdicionadosComboAluno(int numeroDeAlunosAdicionadosComboStudent)
   {
      ClassPanel.numeroDeAlunosAdicionadosComboAluno = numeroDeAlunosAdicionadosComboStudent;
   }

   public static int getNumeroDeAlunosAdicionadosComboNomeDoAluno()
   {
      return numeroDeAlunosAdicionadosComboNomeDoAluno;
   }

   public static void setNumeroDeAlunosAdicionadosComboNomeDoAluno(int numeroDeAlunosAdicionadosComboStudentName)
   {
      ClassPanel.numeroDeAlunosAdicionadosComboNomeDoAluno = numeroDeAlunosAdicionadosComboStudentName;
   }

   public static int getNumeroDeAlunosAdicionadosComboAdicionarAluno()
   {
      return numeroDeAlunosAdicionadosComboAdicionarAluno;
   }

   public static void setNumeroDeAlunosAdicionadosComboAdicionarAluno(int numeroDeAlunosAdicionadosComboAddStudent)
   {
      ClassPanel.numeroDeAlunosAdicionadosComboAdicionarAluno = numeroDeAlunosAdicionadosComboAddStudent;
   }
   
   public static boolean isStudentAddedComboAluno()
   {
      return alunoAdicionadoComboAluno;
   }

   public static boolean isStudentAddedComboNomeDoAluno()
   {
      return alunoAdicionadoComboNomeDoAluno;
   }

   public static boolean isStudentAddedComboAdicionarAluno()
   {
      return alunoAdicionadoComboAdicionarAluno;
   }

   public static void setStudentAddedCombonomeDoAluno(boolean studentAddedComboStudentName)
   {
      ClassPanel.alunoAdicionadoComboNomeDoAluno = studentAddedComboStudentName;
   }

   public static void setStudentAddedComboAdicionarAluno(boolean studentAddedComboAddStudent)
   {
      ClassPanel.alunoAdicionadoComboAdicionarAluno = studentAddedComboAddStudent;
   }
   
   public static void setStudentAddedComboAluno(boolean studentAdded)
   {
      ClassPanel.alunoAdicionadoComboAluno = studentAdded;
   }

   public static String getCampoTurma()
   {
        return campoTurma.getText();
   }

   public static String getCampoAnoLetivo()
   {
        return campoAnoLetivo.getText();
   }
   
   public void limpaCamposEditarTurma()
   {
      campoAnoLetivoEditarTurma.setText("");
      comboRemoverAluno.removeAllItems();
   }

   private void limpaCamposCadastrarTurma()
   {
      campoTurma.setText("");
      campoAnoLetivo.setText("");
   }
}
